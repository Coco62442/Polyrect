"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[259],{3259:function(e,t,o){o.r(t),o.d(t,{default:function(){return j}});var n=o(3396),s=o(7139),l=o(9242);const a=(0,n.Uk)("Ajouter des Notes"),r=(0,n.Uk)("Modifier des Notes"),i=(0,n.Uk)("Ajouter des Absences"),u=(0,n.Uk)("Modifier des Absences"),c=(0,n.Uk)("Mettre à jour votre profil"),p=(0,n._)("hr",null,null,-1),d=["onClick"],h=["onSubmit"],f=["onUpdate:modelValue"],m=["onUpdate:modelValue"],g=(0,n._)("button",{class:"input",type:"submit"},"Mettre à jour",-1),w=["onClick"];function y(e,t,o,y,k,v){const _=(0,n.up)("router-link");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("nav",null,[(0,n.Wm)(_,{to:"/loginProf"},{default:(0,n.w5)((()=>[a])),_:1}),(0,n.Wm)(_,{to:"/modifNote"},{default:(0,n.w5)((()=>[r])),_:1}),(0,n.Wm)(_,{to:"/ajoutAbsence"},{default:(0,n.w5)((()=>[i])),_:1}),(0,n.Wm)(_,{to:"/modifAbsence"},{default:(0,n.w5)((()=>[u])),_:1}),(0,n.Wm)(_,{to:"/profilProf"},{default:(0,n.w5)((()=>[c])),_:1})]),(0,n._)("button",{onClick:t[0]||(t[0]=e=>v.profLogout()),class:"deconnexion"},"Déconnexion"),p,((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.listeEleve,((t,o)=>((0,n.wg)(),(0,n.iD)("div",{key:t._id},[(0,n._)("li",null,[(0,n._)("a",{href:"#",onClick:e=>v.getAllNotesByEleve(t._id,o)},[(0,n._)("p",null,(0,s.zw)(t.prenom)+" "+(0,s.zw)(t.nom),1)],8,d),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.notesMat,(s=>(0,n.wy)(((0,n.wg)(),(0,n.iD)("div",{key:s},[(0,n._)("form",{onSubmit:(0,l.iM)((e=>v.putNote(s._id,s.note,s.num)),["prevent"])},[(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":e=>s.note=e,class:"input",type:"number",min:"0",max:"20"},null,8,f),[[l.nr,s.note]])]),(0,n._)("div",null,[(0,n.wy)((0,n._)("input",{"onUpdate:modelValue":e=>s.num=e,class:"input",type:"number",min:"0"},null,8,m),[[l.nr,s.num]])]),g],40,h),(0,n._)("button",{onClick:e=>v.delNote(s._id,t._id,o),class:"input",type:"submit"},"Supprimer la note",8,w)])),[[l.F8,e.showNotes[o]]]))),128))])])))),128))])}const k=top.glob,v=k+"eleve",_=k+"matiere",b=k+"note";var N={name:"modifNote",data:()=>({idProf:localStorage.getItem("idProf"),idMat:String,listeEleve:[],notesMat:[],showNotes:[]}),beforeMount(){this.getListeEleves().then((()=>{this.notShowMessage()})),this.getIdMat()},methods:{profLogout(){localStorage.removeItem("tokenProf"),localStorage.removeItem("idProf"),localStorage.clear(),this.$router.push("/prof")},async getListeEleves(){try{let e=await fetch(v,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?this.$router.push("/prof"):(console.log("Erreur du serveur"),alert("Le chargement des donnés n'a pas pu être fait"))}catch(e){console.log(e)}},notShowMessage(){for(let e=0;e<this.listeEleve.length;e++)this.showNotes[e]=!1},async getIdMat(){try{let e=await fetch(_+"/"+this.idProf,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(e.ok){let t=await e.json();this.idMat=t.mat._id}else 401==e.status?this.$router.push("/prof"):(console.log("Erreur du serveur"),alert("Le chargement des donnés n'a pas pu être fait"))}catch(e){console.log(e)}},async getAllNotesByEleve(e,t){try{this.notShowMessage();let o=await fetch(b+"/note/"+e+"/"+this.idMat,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(o.ok){let e=await o.json();this.notesMat=e.notes,this.showNotes[t]=!0}else 401==o.status&&(alert("Vous n'êtes plus connecté"),this.$router.push("/prof"))}catch{console.log("err")}return!1},async putNote(e,t,o){console.log(e,t,o),await fetch(b+"/"+e,{method:"PUT",body:JSON.stringify({note:t,num:o}),headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}}).then((e=>{e.ok?alert("Note mis à jour"):401==e.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Problème lors de la mise à jour de la note")})).catch((e=>{console.log(e)}))},async delNote(e,t,o){const n=confirm("Voulez-vous confirmez la supression?");if(n)try{let n=await fetch(b+"/"+e,{method:"DELETE",headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});n.ok?(alert("Note supprimée"),this.getAllNotesByEleve(t,o)):401==n.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Problème lors de la supression de la note")}catch(s){console.log(s)}}}},M=o(89);const S=(0,M.Z)(N,[["render",y]]);var j=S}}]);
//# sourceMappingURL=259.663f6b1a.js.map