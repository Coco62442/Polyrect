"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[584],{3584:function(e,t,o){o.r(t),o.d(t,{default:function(){return S}});var s=o(3396),n=o(7139),l=o(9242);const i=(0,s.Uk)("Ajouter des Notes"),a=(0,s.Uk)("Modifier des Notes"),r=(0,s.Uk)("Ajouter des Absences"),c=(0,s.Uk)("Modifier des Absences"),u=(0,s.Uk)("Mettre à jour votre profil"),d=(0,s._)("hr",null,null,-1),p=["onClick"],h=["onSubmit"],f=["onUpdate:modelValue"],m=["onUpdate:modelValue"],b=["onUpdate:modelValue"],g=(0,s._)("button",{class:"input",type:"submit"},"Mettre à jour",-1),w=["onClick"];function A(e,t,o,A,y,k){const v=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("nav",null,[(0,s.Wm)(v,{to:"/loginProf"},{default:(0,s.w5)((()=>[i])),_:1}),(0,s.Wm)(v,{to:"/modifNote"},{default:(0,s.w5)((()=>[a])),_:1}),(0,s.Wm)(v,{to:"/ajoutAbsence"},{default:(0,s.w5)((()=>[r])),_:1}),(0,s.Wm)(v,{to:"/modifAbsence"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(v,{to:"/profilProf"},{default:(0,s.w5)((()=>[u])),_:1})]),(0,s._)("button",{onClick:t[0]||(t[0]=e=>k.profLogout()),class:"deconnexion"},"Déconnexion"),d,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeEleve,((t,o)=>((0,s.wg)(),(0,s.iD)("div",{key:t._id},[(0,s._)("li",null,[(0,s._)("a",{href:"#",onClick:e=>k.getAllAbsencesByEleve(t._id,o)},(0,n.zw)(t.prenom)+" "+(0,n.zw)(t.nom),9,p),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeAbsence,(n=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{key:n},[(0,s._)("form",{onSubmit:(0,l.iM)((e=>k.putAbsence(n._id,n.justification,n.justifie,n.date,t._id)),["prevent"])},[(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.justification=e,class:"input",type:"text",id:"justification",placeholder:"Entrer une justification d'absence"},null,8,f),[[l.nr,n.justification]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.justifie=e,class:"input",type:"checkbox",checked:"",id:"justifie"},null,8,m),[[l.e8,n.justifie]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.date=e,class:"input",type:"text",id:"date"},null,8,b),[[l.nr,n.date]])]),g],40,h),(0,s._)("button",{onClick:e=>k.delAbsence(n._id,t._id,o),class:"input",type:"submit"},"Supprimer l'absence",8,w)])),[[l.F8,e.showFormAbsence[o]]]))),128))])])))),128))])}const y="https://polyrecte-serveur.herokuapp.com/",k=y+"absence",v=y+"eleve";var j={name:"modifAbsence",data:()=>({listeEleve:[],listeAbsence:[],showFormAbsence:[],error:""}),beforeMount(){this.getListeEleves().then((()=>{this.notShowAbsences()}))},methods:{profLogout(){localStorage.removeItem("token"),localStorage.removeItem("id"),localStorage.clear(),this.$router.push("/prof")},async getListeEleves(){try{let e=await fetch(v,{headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):(console.log("Erreur du serveur"),alert("Le chargement des donnés n'a pas pu être fait"))}catch(e){console.log(e)}},notShowAbsences(){for(let e=0;e<this.listeEleve.length;e++)this.showFormAbsence[e]=!1},async getAllAbsencesByEleve(e,t){try{this.notShowAbsences();let o=await fetch(k+"/"+e,{headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});if(o.ok){let e=await o.json();this.listeAbsence=e.absence,this.showFormAbsence[t]=!0,console.log(this.listeAbsence,this.listeAbsence[0].justification)}else 401==o.status&&(alert("Vous n'êtes plus connecté"),this.$router.push("/prof"))}catch{console.log("err")}return!1},async putAbsence(e,t,o,s,n){await fetch(k+"/"+e,{method:"PUT",body:JSON.stringify({justification:t,justifie:o,date:s,eleve:n}),headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}}).then((e=>{e.ok?alert("Absence mis à jour"):401==e.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Problème lors de la mise à jour de l'absence")})).catch((e=>{console.log(e)}))},async delAbsence(e,t,o){const s=confirm("Voulez-vous confirmez la supression?");if(s)try{let s=await fetch(k+"/"+e,{method:"DELETE",headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});s.ok?(alert("Absence supprimée"),this.getAllAbsencesByEleve(t,o)):401==s.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Problème lors de la supression de l'absence")}catch(n){console.log(n)}}}},_=o(89);const E=(0,_.Z)(j,[["render",A]]);var S=E}}]);
//# sourceMappingURL=584.cfe34001.js.map