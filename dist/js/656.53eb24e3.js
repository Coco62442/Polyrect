"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[656],{1656:function(e,t,o){o.r(t),o.d(t,{default:function(){return S}});var s=o(3396),n=o(7139),l=o(9242);const i=(0,s.Uk)("Ajouter des Notes"),a=(0,s.Uk)("Modifier des Notes"),r=(0,s.Uk)("Ajouter des Absences"),c=(0,s.Uk)("Modifier des Absences"),u=(0,s.Uk)("Mettre à jour votre profil"),p=(0,s._)("hr",null,null,-1),d=["onClick"],f=["onSubmit"],b=["onUpdate:modelValue"],h=["onUpdate:modelValue"],g=["onUpdate:modelValue"],m=(0,s._)("button",{class:"input",type:"submit"},"Mettre à jour",-1),w=["onClick"];function v(e,t,o,v,y,A){const k=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("nav",null,[(0,s.Wm)(k,{to:"/loginProf"},{default:(0,s.w5)((()=>[i])),_:1}),(0,s.Wm)(k,{to:"/modifNote"},{default:(0,s.w5)((()=>[a])),_:1}),(0,s.Wm)(k,{to:"/ajoutAbsence"},{default:(0,s.w5)((()=>[r])),_:1}),(0,s.Wm)(k,{to:"/modifAbsence"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(k,{to:"/profilProf"},{default:(0,s.w5)((()=>[u])),_:1})]),(0,s._)("button",{onClick:t[0]||(t[0]=e=>A.profLogout()),class:"deconnexion"},"Déconnexion"),p,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeEleve,((t,o)=>((0,s.wg)(),(0,s.iD)("div",{key:t._id},[(0,s._)("li",null,[(0,s._)("a",{href:"#",onClick:e=>A.getAllAbsencesByEleve(t._id,o)},(0,n.zw)(t.prenom)+" "+(0,n.zw)(t.nom),9,d),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeAbsence,(n=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{key:n},[(0,s._)("form",{onSubmit:(0,l.iM)((e=>A.putAbsence(n._id,n.justification,n.justifie,n.date,t._id)),["prevent"])},[(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.justification=e,class:"input",type:"text",id:"justification",placeholder:"Entrer une justification d'absence"},null,8,b),[[l.nr,n.justification]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.justifie=e,class:"input",type:"checkbox",checked:"",id:"justifie"},null,8,h),[[l.e8,n.justifie]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":e=>n.date=e,class:"input",type:"text",id:"date"},null,8,g),[[l.nr,n.date]])]),m],40,f),(0,s._)("button",{onClick:e=>A.delAbsence(n._id,t._id,o),class:"input",type:"submit"},"Supprimer l'absence",8,w)])),[[l.F8,e.showFormAbsence[o]]]))),128))])])))),128))])}const y=top.glob.serv,A=y+"absence",k=y+"eleve";var _={name:"modifAbsence",data:()=>({listeEleve:[],listeAbsence:[],showFormAbsence:[],error:""}),beforeMount(){this.getListeEleves().then((()=>{this.notShowAbsences()}))},methods:{profLogout(){localStorage.removeItem("tokenProf"),localStorage.removeItem("idProf"),localStorage.clear(),this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")},async getListeEleves(){try{let e=await fetch(k,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):(console.log("Erreur du serveur"),top.glob.toast("Le chargement des donnés n'a pas pu être fait","warning"))}catch(e){console.log(e),top.glob.toast("Erreur","danger")}},notShowAbsences(){for(let e=0;e<this.listeEleve.length;e++)this.showFormAbsence[e]=!1},async getAllAbsencesByEleve(e,t){try{this.notShowAbsences();let o=await fetch(A+"/"+e,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(o.ok){let e=await o.json();this.listeAbsence=e.absence,this.showFormAbsence[t]=!0}else 401==o.status&&(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info"))}catch{console.log("err"),top.glob.toast("Erreur","danger")}return!1},async putAbsence(e,t,o,s,n){await fetch(A+"/"+e,{method:"PUT",body:JSON.stringify({justification:t,justifie:o,date:s,eleve:n}),headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}}).then((e=>{e.ok?top.glob.toast("Absence mis à jour","success"):401==e.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):top.glob.toast("Problème lors de la mise à jour de l'absence","warning")})).catch((e=>{console.log(e),top.glob.toast("Erreur","danger")}))},async delAbsence(e,t,o){const s=confirm("Voulez-vous confirmez la supression?");if(s)try{let s=await fetch(A+"/"+e,{method:"DELETE",headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});s.ok?(top.glob.toast("Absence supprimée","success"),this.getAllAbsencesByEleve(t,o)):401==s.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):top.glob.toast("Problème lors de la supression de l'absence","warning")}catch(n){console.log(n),top.glob.toast("Erreur","danger")}}}},j=o(89);const E=(0,j.Z)(_,[["render",v]]);var S=E}}]);
//# sourceMappingURL=656.53eb24e3.js.map