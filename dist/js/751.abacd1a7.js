"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[751],{4751:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var o=s(3396),i=s(7139),n=s(9242);const l=(0,o.Uk)("Ajouter des Notes"),a=(0,o.Uk)("Modifier des Notes"),r=(0,o.Uk)("Ajouter des Absences"),c=(0,o.Uk)("Modifier des Absences"),u=(0,o.Uk)("Mettre à jour votre profil"),d=(0,o._)("hr",null,null,-1),h=["onClick"],f=["onSubmit"],p=(0,o._)("button",{type:"submit",class:"input"},"Mettre à jour",-1);function b(e,t,s,b,w,m){const j=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o._)("nav",null,[(0,o.Wm)(j,{to:"/loginProf"},{default:(0,o.w5)((()=>[l])),_:1}),(0,o.Wm)(j,{to:"/modifNote"},{default:(0,o.w5)((()=>[a])),_:1}),(0,o.Wm)(j,{to:"/ajoutAbsence"},{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(j,{to:"/modifAbsence"},{default:(0,o.w5)((()=>[c])),_:1}),(0,o.Wm)(j,{to:"/profilProf"},{default:(0,o.w5)((()=>[u])),_:1})]),(0,o._)("button",{onClick:t[0]||(t[0]=e=>m.profLogout()),class:"deconnexion"},"Déconnexion"),d,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.listeEleve,((s,l)=>((0,o.wg)(),(0,o.iD)("div",{key:s._id},[(0,o._)("li",null,[(0,o._)("a",{href:"#",onClick:e=>m.getAllAbsencesByEleve(s._id,l)},(0,i.zw)(s.prenom)+" "+(0,i.zw)(s.nom),9,h),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.listeAbsence,(t=>(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{key:t},[(0,o._)("li",null," Date: "+(0,i.zw)(t.date)+" Justifié: "+(0,i.zw)(t.justifie)+" Justification: "+(0,i.zw)(t.justification),1)])),[[n.F8,e.showFormAbsence[l]]]))),128))]),(0,o.wy)((0,o._)("div",null,[(0,o._)("form",{onSubmit:(0,n.iM)((e=>m.creerAbsence(s._id,l)),["prevent"])},[(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.justification=t),class:"input",type:"text",id:"justification",placeholder:"Entrer une justification d'absence"},null,512),[[n.nr,e.justification]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.justifie=t),class:"input",type:"checkbox",checked:"",id:"justifie"},null,512),[[n.e8,e.justifie]])]),(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.date=t),class:"input",type:"text",id:"date"},null,512),[[n.nr,e.date]])]),p],40,f)],512),[[n.F8,e.showFormAbsence[l]]])])))),128))])}const w="https://polyrecte-serveur.herokuapp.com/",m=w+"eleve",j=w+"absence";var g={name:"abscence",data:()=>({listeEleve:[],listeAbsence:[],showFormAbsence:[],justification:"",justifie:Boolean,date:""}),beforeMount(){this.getListeEleves().then((()=>{this.notShowAbsences()}))},methods:{profLogout(){localStorage.removeItem("token"),localStorage.removeItem("id"),localStorage.clear(),this.$router.push("/prof")},async getListeEleves(){try{let e=await fetch(m,{headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):(console.log("Erreur du serveur"),alert("Le chargement des donnés n'a pas pu être fait"))}catch(e){console.log(e)}},notShowAbsences(){for(let e=0;e<this.listeEleve.length;e++)this.showFormAbsence[e]=!1},async getAllAbsencesByEleve(e,t){try{this.notShowAbsences();let s=await fetch(j+"/"+e,{headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});if(s.ok){let e=await s.json();this.listeAbsence=e.absence,this.showFormAbsence[t]=!0;for(let t=0;t<this.listeAbsence.length;t++)this.listeAbsence[t].justifie?this.listeAbsence[t].justifie="Oui":this.listeAbsence[t].justifie="Non"}else 401==s.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Erreur lors de la récupération des données")}catch{console.log("err")}return!1},async creerAbsence(e,t){try{let s=await fetch(j,{method:"POST",body:JSON.stringify({justifie:this.justifie,justification:this.justification,date:this.date,eleve:e}),headers:{"content-type":"application/json",authorization:localStorage.getItem("token")}});s.ok?(this.justification="",this.justifie="",this.date="",this.getAllAbsencesByEleve(e,t),alert("Absence ajouté à l'élève")):401==s.status?(alert("Vous n'êtes plus connecté"),this.$router.push("/prof")):alert("Erreur lors de la création de l'absence")}catch(s){console.log(s)}}}},v=s(89);const A=(0,v.Z)(g,[["render",b]]);var y=A}}]);
//# sourceMappingURL=751.abacd1a7.js.map