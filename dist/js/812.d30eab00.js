"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[812],{6812:function(e,t,o){o.r(t),o.d(t,{default:function(){return y}});var s=o(3396),n=o(7139),i=o(9242);const l=(0,s.Uk)("Ajouter des Notes"),a=(0,s.Uk)("Modifier des Notes"),r=(0,s.Uk)("Ajouter des Absences"),c=(0,s.Uk)("Modifier des Absences"),u=(0,s.Uk)("Mettre à jour votre profil"),f=(0,s._)("hr",null,null,-1),d=["onClick"],p=["onSubmit"],h=(0,s._)("button",{type:"submit",class:"input"},"Mettre à jour",-1);function b(e,t,o,b,g,w){const m=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("nav",null,[(0,s.Wm)(m,{to:"/loginProf"},{default:(0,s.w5)((()=>[l])),_:1}),(0,s.Wm)(m,{to:"/modifNote"},{default:(0,s.w5)((()=>[a])),_:1}),(0,s.Wm)(m,{to:"/ajoutAbsence"},{default:(0,s.w5)((()=>[r])),_:1}),(0,s.Wm)(m,{to:"/modifAbsence"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(m,{to:"/profilProf"},{default:(0,s.w5)((()=>[u])),_:1})]),(0,s._)("button",{onClick:t[0]||(t[0]=e=>w.profLogout()),class:"deconnexion"},"Déconnexion"),f,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeEleve,((o,l)=>((0,s.wg)(),(0,s.iD)("div",{key:o._id},[(0,s._)("li",null,[(0,s._)("a",{href:"#",onClick:e=>w.getAllAbsencesByEleve(o._id,l)},(0,n.zw)(o.prenom)+" "+(0,n.zw)(o.nom),9,d),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeAbsence,(t=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{key:t},[(0,s._)("li",null," Date: "+(0,n.zw)(t.date)+" Justifié: "+(0,n.zw)(t.justifie)+" Justification: "+(0,n.zw)(t.justification),1)])),[[i.F8,e.showFormAbsence[l]]]))),128))]),(0,s.wy)((0,s._)("div",null,[(0,s._)("form",{onSubmit:(0,i.iM)((e=>w.creerAbsence(o._id,l)),["prevent"])},[(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.justification=t),class:"input",type:"text",id:"justification",placeholder:"Entrer une justification d'absence"},null,512),[[i.nr,e.justification]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.justifie=t),class:"input",type:"checkbox",checked:"",id:"justifie"},null,512),[[i.e8,e.justifie]])]),(0,s._)("div",null,[(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.date=t),class:"input",type:"text",id:"date"},null,512),[[i.nr,e.date]])]),h],40,p)],512),[[i.F8,e.showFormAbsence[l]]])])))),128))])}const g=top.glob.serv,w=g+"eleve",m=g+"absence";var j={name:"abscence",data:()=>({listeEleve:[],listeAbsence:[],showFormAbsence:[],justification:"",justifie:Boolean,date:""}),beforeMount(){this.getListeEleves().then((()=>{this.notShowAbsences()}))},methods:{profLogout(){localStorage.removeItem("tokenProf"),localStorage.removeItem("idProf"),localStorage.clear(),this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")},async getListeEleves(){try{let e=await fetch(w,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):(console.log("Erreur du serveur"),top.glob.toast("Le chargement des donnés n'a pas pu être fait","warning"))}catch(e){console.log(e),top.glob.toast("Erreur","danger")}},notShowAbsences(){for(let e=0;e<this.listeEleve.length;e++)this.showFormAbsence[e]=!1},async getAllAbsencesByEleve(e,t){try{this.notShowAbsences();let o=await fetch(m+"/"+e,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(o.ok){let e=await o.json();this.listeAbsence=e.absence,this.showFormAbsence[t]=!0;for(let t=0;t<this.listeAbsence.length;t++)this.listeAbsence[t].justifie?this.listeAbsence[t].justifie="Oui":this.listeAbsence[t].justifie="Non"}else 401==o.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):top.glob.toast("Erreur lors de la récupération des données","danger")}catch{console.log("err"),top.glob.toast("Erreur","danger")}return!1},async creerAbsence(e,t){try{let o=await fetch(m,{method:"POST",body:JSON.stringify({justifie:this.justifie,justification:this.justification,date:this.date,eleve:e}),headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});o.ok?(this.justification="",this.justifie="",this.date="",this.getAllAbsencesByEleve(e,t),top.glob.toast("Absence ajouté à l'élève","success")):401==o.status?(this.$router.push("/prof"),top.glob.toast("Vous n'êtes pas connecté","info")):top.glob.toast("Erreur lors de la création de l'absence","warning")}catch(o){console.log(o),top.glob.toast("Erreur","danger")}}}},v=o(89);const A=(0,v.Z)(j,[["render",b]]);var y=A}}]);
//# sourceMappingURL=812.d30eab00.js.map