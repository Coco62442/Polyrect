"use strict";(self["webpackChunkpolyrecte"]=self["webpackChunkpolyrecte"]||[]).push([[86],{7086:function(e,t,o){o.r(t),o.d(t,{default:function(){return E}});var s=o(3396),i=o(7139),n=o(9242);const l=(0,s.Uk)("Ajouter des Notes"),a=(0,s.Uk)("Modifier des Notes"),r=(0,s.Uk)("Ajouter des Absences"),c=(0,s.Uk)("Modifier des Absences"),u=(0,s.Uk)("Mettre à jour votre profil"),f=(0,s._)("hr",null,null,-1),d=["onClick"],p=["onSubmit"],h=(0,s._)("label",{for:"justification"},"Justification: ",-1),b=(0,s._)("label",{for:"justifie"},"Justifié: ",-1),g=(0,s._)("label",{for:"date"},"Date: ",-1),w=(0,s._)("button",{type:"submit",class:"input"},"Mettre à jour",-1);function j(e,t,o,j,m,A){const v=(0,s.up)("router-link");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("nav",null,[(0,s.Wm)(v,{to:"/loginProf"},{default:(0,s.w5)((()=>[l])),_:1}),(0,s.Wm)(v,{to:"/modifNote"},{default:(0,s.w5)((()=>[a])),_:1}),(0,s.Wm)(v,{to:"/ajoutAbsence"},{default:(0,s.w5)((()=>[r])),_:1}),(0,s.Wm)(v,{to:"/modifAbsence"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(v,{to:"/profilProf"},{default:(0,s.w5)((()=>[u])),_:1})]),(0,s._)("button",{onClick:t[0]||(t[0]=e=>A.profLogout()),class:"deconnexion"},"Déconnexion"),f,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeEleve,((o,l)=>((0,s.wg)(),(0,s.iD)("div",{key:o._id},[(0,s._)("li",null,[(0,s._)("a",{href:"#",onClick:e=>A.getAllAbsencesByEleve(o._id,l)},(0,i.zw)(o.prenom)+" "+(0,i.zw)(o.nom),9,d),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.listeAbsence,(t=>(0,s.wy)(((0,s.wg)(),(0,s.iD)("div",{key:t},[(0,s._)("li",null," Date: "+(0,i.zw)(t.date)+" Justifié: "+(0,i.zw)(t.justifie)+" Justification: "+(0,i.zw)(t.justification),1)])),[[n.F8,e.showFormAbsence[l]]]))),128))]),(0,s.wy)((0,s._)("div",null,[(0,s._)("form",{onSubmit:(0,n.iM)((e=>A.creerAbsence(o._id,l)),["prevent"]),class:"align"},[(0,s._)("p",null,[h,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[1]||(t[1]=t=>e.justification=t),class:"input",type:"text",id:"justification",placeholder:"Entrer une justification d'absence"},null,512),[[n.nr,e.justification]])]),(0,s._)("p",null,[b,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.justifie=t),class:"input",type:"checkbox",checked:"",id:"justifie"},null,512),[[n.e8,e.justifie]])]),(0,s._)("p",null,[g,(0,s.wy)((0,s._)("input",{"onUpdate:modelValue":t[3]||(t[3]=t=>e.date=t),class:"input",type:"text",id:"date"},null,512),[[n.nr,e.date]])]),w],40,p)],512),[[n.F8,e.showFormAbsence[l]]])])))),128))])}const m=top.glob.serv,A=m+"eleve",v=m+"absence";var y={name:"abscence",data:()=>({listeEleve:[],listeAbsence:[],showFormAbsence:[],justification:"",justifie:Boolean,date:""}),beforeMount(){this.getListeEleves().then((()=>{this.notShowAbsences()}))},methods:{profLogout(){localStorage.removeItem("tokenProf"),localStorage.removeItem("idProf"),localStorage.clear(),this.$router.push("/prof"),top.glob.toast("Vous êtes déconnecté","info")},async getListeEleves(){try{let e=await fetch(A,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(e.ok){let t=await e.json();this.listeEleve=t.eleves}else 401==e.status?(this.$router.push("/prof"),top.glob.toast("Vous êtes déconnecté","info")):(console.log("Erreur du serveur"),top.glob.toast("Le chargement des donnés n'a pas pu être fait","warning"))}catch(e){console.log(e),top.glob.toast("Erreur","danger")}},notShowAbsences(){for(let e=0;e<this.listeEleve.length;e++)this.showFormAbsence[e]=!1},async getAllAbsencesByEleve(e,t){try{this.notShowAbsences();let o=await fetch(v+"/"+e,{headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});if(o.ok){let e=await o.json();this.listeAbsence=e.absence,this.showFormAbsence[t]=!0;for(let t=0;t<this.listeAbsence.length;t++)this.listeAbsence[t].justifie?this.listeAbsence[t].justifie="Oui":this.listeAbsence[t].justifie="Non"}else 401==o.status?(this.$router.push("/prof"),top.glob.toast("Vous êtes déconnecté","info")):top.glob.toast("Erreur lors de la récupération des données","danger")}catch{console.log("err"),top.glob.toast("Erreur","danger")}return!1},async creerAbsence(e,t){try{let o=await fetch(v,{method:"POST",body:JSON.stringify({justifie:this.justifie,justification:this.justification,date:this.date,eleve:e}),headers:{"content-type":"application/json",authorization:localStorage.getItem("tokenProf")}});o.ok?(this.justification="",this.justifie="",this.date="",this.getAllAbsencesByEleve(e,t),top.glob.toast("Absence ajouté à l'élève","success")):401==o.status?(this.$router.push("/prof"),top.glob.toast("Vous êtes déconnecté","info")):top.glob.toast("Erreur lors de la création de l'absence","warning")}catch(o){console.log(o),top.glob.toast("Erreur","danger")}}}},_=o(89);const k=(0,_.Z)(y,[["render",j]]);var E=k}}]);
//# sourceMappingURL=86.c381cdff.js.map